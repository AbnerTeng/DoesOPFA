)
segments(x.pos,0,x.pos,df[,Volume])
dev.off()
}
df[,plot_ohlc(.SD,filename=group_id),
by=group_id]
#library(quantmod)
#getSymbols("IBM", src="yahoo")
library(data.table)
#IBM = readRDS("IBM.RDS")
data_path <- "/Users/abnerteng/Desktop/DJ_split/recolumn_data/MCD.csv"
df = fread(data_path)
#df = as.data.table(df[,1:8])
#setnames(df,1:5,c("Open","High","Low","Close","Volume"))
#group_id = sort(rep(1:(nrow(df)/20),20))
group_id = paste0(df[,y],df[,m])
df = df[1:length(group_id)]
df[,group_id := group_id]
## fig_path <- paste0("/Users/abnerteng/Desktop/DJ_stock_fig/AAPL/AAPL_",group_id, sep = "")
plot_ohlc = function(df,filename="plot_01") {
png(paste0(filename,".png"),width=60,height=60)
layout(matrix(1:2,2,1),
heights=c(4,1))    # the ratio between price and volume chart is 60:15
par(mar=c(0,0,0,0),
bg="black",
fg="white",
lwd=1)
plot.new()
plot.window(xlim=c(0,59),   # x starts from zero
ylim=c(min(df[,Low]),max(df[,High])),
xaxs='i'
)
x.pos = seq(1,58,3)   # day 1 is x=1, and leave one pixel each at left and right (x=0,x=2)
# draw vertical line High-Low
segments(x.pos,df[,Low],x.pos,df[,High])
# draw CLOSE notch
segments(x.pos,df[,Close],x.pos+1,df[,Close])
# draw OPEN notch
segments(x.pos-1,df[,Open],x.pos,df[,Open])
# draw MA line
segments(x.pos-1,df[,MA],x.pos+1,df[,MA])
# add Volume
plot.new()
plot.window(xlim=c(0,59),
ylim=range(df[,Volume]),
xaxs='i'
)
segments(x.pos,0,x.pos,df[,Volume])
dev.off()
}
df[,plot_ohlc(.SD,filename=group_id),
by=group_id]
#library(quantmod)
#getSymbols("IBM", src="yahoo")
library(data.table)
#IBM = readRDS("IBM.RDS")
data_path <- "/Users/abnerteng/Desktop/DJ_split/recolumn_data/MMM.csv"
df = fread(data_path)
#df = as.data.table(df[,1:8])
#setnames(df,1:5,c("Open","High","Low","Close","Volume"))
#group_id = sort(rep(1:(nrow(df)/20),20))
group_id = paste0(df[,y],df[,m])
df = df[1:length(group_id)]
df[,group_id := group_id]
## fig_path <- paste0("/Users/abnerteng/Desktop/DJ_stock_fig/AAPL/AAPL_",group_id, sep = "")
plot_ohlc = function(df,filename="plot_01") {
png(paste0(filename,".png"),width=60,height=60)
layout(matrix(1:2,2,1),
heights=c(4,1))    # the ratio between price and volume chart is 60:15
par(mar=c(0,0,0,0),
bg="black",
fg="white",
lwd=1)
plot.new()
plot.window(xlim=c(0,59),   # x starts from zero
ylim=c(min(df[,Low]),max(df[,High])),
xaxs='i'
)
x.pos = seq(1,58,3)   # day 1 is x=1, and leave one pixel each at left and right (x=0,x=2)
# draw vertical line High-Low
segments(x.pos,df[,Low],x.pos,df[,High])
# draw CLOSE notch
segments(x.pos,df[,Close],x.pos+1,df[,Close])
# draw OPEN notch
segments(x.pos-1,df[,Open],x.pos,df[,Open])
# draw MA line
segments(x.pos-1,df[,MA],x.pos+1,df[,MA])
# add Volume
plot.new()
plot.window(xlim=c(0,59),
ylim=range(df[,Volume]),
xaxs='i'
)
segments(x.pos,0,x.pos,df[,Volume])
dev.off()
}
df[,plot_ohlc(.SD,filename=group_id),
by=group_id]
#library(quantmod)
#getSymbols("IBM", src="yahoo")
library(data.table)
#IBM = readRDS("IBM.RDS")
data_path <- "/Users/abnerteng/Desktop/DJ_split/recolumn_data/MRK.csv"
df = fread(data_path)
#df = as.data.table(df[,1:8])
#setnames(df,1:5,c("Open","High","Low","Close","Volume"))
#group_id = sort(rep(1:(nrow(df)/20),20))
group_id = paste0(df[,y],df[,m])
df = df[1:length(group_id)]
df[,group_id := group_id]
## fig_path <- paste0("/Users/abnerteng/Desktop/DJ_stock_fig/AAPL/AAPL_",group_id, sep = "")
plot_ohlc = function(df,filename="plot_01") {
png(paste0(filename,".png"),width=60,height=60)
layout(matrix(1:2,2,1),
heights=c(4,1))    # the ratio between price and volume chart is 60:15
par(mar=c(0,0,0,0),
bg="black",
fg="white",
lwd=1)
plot.new()
plot.window(xlim=c(0,59),   # x starts from zero
ylim=c(min(df[,Low]),max(df[,High])),
xaxs='i'
)
x.pos = seq(1,58,3)   # day 1 is x=1, and leave one pixel each at left and right (x=0,x=2)
# draw vertical line High-Low
segments(x.pos,df[,Low],x.pos,df[,High])
# draw CLOSE notch
segments(x.pos,df[,Close],x.pos+1,df[,Close])
# draw OPEN notch
segments(x.pos-1,df[,Open],x.pos,df[,Open])
# draw MA line
segments(x.pos-1,df[,MA],x.pos+1,df[,MA])
# add Volume
plot.new()
plot.window(xlim=c(0,59),
ylim=range(df[,Volume]),
xaxs='i'
)
segments(x.pos,0,x.pos,df[,Volume])
dev.off()
}
df[,plot_ohlc(.SD,filename=group_id),
by=group_id]
#library(quantmod)
#getSymbols("IBM", src="yahoo")
library(data.table)
#IBM = readRDS("IBM.RDS")
data_path <- "/Users/abnerteng/Desktop/DJ_split/recolumn_data/MSFT.csv"
df = fread(data_path)
#df = as.data.table(df[,1:8])
#setnames(df,1:5,c("Open","High","Low","Close","Volume"))
#group_id = sort(rep(1:(nrow(df)/20),20))
group_id = paste0(df[,y],df[,m])
df = df[1:length(group_id)]
df[,group_id := group_id]
## fig_path <- paste0("/Users/abnerteng/Desktop/DJ_stock_fig/AAPL/AAPL_",group_id, sep = "")
plot_ohlc = function(df,filename="plot_01") {
png(paste0(filename,".png"),width=60,height=60)
layout(matrix(1:2,2,1),
heights=c(4,1))    # the ratio between price and volume chart is 60:15
par(mar=c(0,0,0,0),
bg="black",
fg="white",
lwd=1)
plot.new()
plot.window(xlim=c(0,59),   # x starts from zero
ylim=c(min(df[,Low]),max(df[,High])),
xaxs='i'
)
x.pos = seq(1,58,3)   # day 1 is x=1, and leave one pixel each at left and right (x=0,x=2)
# draw vertical line High-Low
segments(x.pos,df[,Low],x.pos,df[,High])
# draw CLOSE notch
segments(x.pos,df[,Close],x.pos+1,df[,Close])
# draw OPEN notch
segments(x.pos-1,df[,Open],x.pos,df[,Open])
# draw MA line
segments(x.pos-1,df[,MA],x.pos+1,df[,MA])
# add Volume
plot.new()
plot.window(xlim=c(0,59),
ylim=range(df[,Volume]),
xaxs='i'
)
segments(x.pos,0,x.pos,df[,Volume])
dev.off()
}
df[,plot_ohlc(.SD,filename=group_id),
by=group_id]
#library(quantmod)
#getSymbols("IBM", src="yahoo")
library(data.table)
#IBM = readRDS("IBM.RDS")
data_path <- "/Users/abnerteng/Desktop/DJ_split/recolumn_data/NKE.csv"
df = fread(data_path)
#df = as.data.table(df[,1:8])
#setnames(df,1:5,c("Open","High","Low","Close","Volume"))
#group_id = sort(rep(1:(nrow(df)/20),20))
group_id = paste0(df[,y],df[,m])
df = df[1:length(group_id)]
df[,group_id := group_id]
## fig_path <- paste0("/Users/abnerteng/Desktop/DJ_stock_fig/AAPL/AAPL_",group_id, sep = "")
plot_ohlc = function(df,filename="plot_01") {
png(paste0(filename,".png"),width=60,height=60)
layout(matrix(1:2,2,1),
heights=c(4,1))    # the ratio between price and volume chart is 60:15
par(mar=c(0,0,0,0),
bg="black",
fg="white",
lwd=1)
plot.new()
plot.window(xlim=c(0,59),   # x starts from zero
ylim=c(min(df[,Low]),max(df[,High])),
xaxs='i'
)
x.pos = seq(1,58,3)   # day 1 is x=1, and leave one pixel each at left and right (x=0,x=2)
# draw vertical line High-Low
segments(x.pos,df[,Low],x.pos,df[,High])
# draw CLOSE notch
segments(x.pos,df[,Close],x.pos+1,df[,Close])
# draw OPEN notch
segments(x.pos-1,df[,Open],x.pos,df[,Open])
# draw MA line
segments(x.pos-1,df[,MA],x.pos+1,df[,MA])
# add Volume
plot.new()
plot.window(xlim=c(0,59),
ylim=range(df[,Volume]),
xaxs='i'
)
segments(x.pos,0,x.pos,df[,Volume])
dev.off()
}
df[,plot_ohlc(.SD,filename=group_id),
by=group_id]
#library(quantmod)
#getSymbols("IBM", src="yahoo")
library(data.table)
#IBM = readRDS("IBM.RDS")
data_path <- "/Users/abnerteng/Desktop/DJ_split/recolumn_data/PG.csv"
df = fread(data_path)
#df = as.data.table(df[,1:8])
#setnames(df,1:5,c("Open","High","Low","Close","Volume"))
#group_id = sort(rep(1:(nrow(df)/20),20))
group_id = paste0(df[,y],df[,m])
df = df[1:length(group_id)]
df[,group_id := group_id]
## fig_path <- paste0("/Users/abnerteng/Desktop/DJ_stock_fig/AAPL/AAPL_",group_id, sep = "")
plot_ohlc = function(df,filename="plot_01") {
png(paste0(filename,".png"),width=60,height=60)
layout(matrix(1:2,2,1),
heights=c(4,1))    # the ratio between price and volume chart is 60:15
par(mar=c(0,0,0,0),
bg="black",
fg="white",
lwd=1)
plot.new()
plot.window(xlim=c(0,59),   # x starts from zero
ylim=c(min(df[,Low]),max(df[,High])),
xaxs='i'
)
x.pos = seq(1,58,3)   # day 1 is x=1, and leave one pixel each at left and right (x=0,x=2)
# draw vertical line High-Low
segments(x.pos,df[,Low],x.pos,df[,High])
# draw CLOSE notch
segments(x.pos,df[,Close],x.pos+1,df[,Close])
# draw OPEN notch
segments(x.pos-1,df[,Open],x.pos,df[,Open])
# draw MA line
segments(x.pos-1,df[,MA],x.pos+1,df[,MA])
# add Volume
plot.new()
plot.window(xlim=c(0,59),
ylim=range(df[,Volume]),
xaxs='i'
)
segments(x.pos,0,x.pos,df[,Volume])
dev.off()
}
df[,plot_ohlc(.SD,filename=group_id),
by=group_id]
#library(quantmod)
#getSymbols("IBM", src="yahoo")
library(data.table)
#IBM = readRDS("IBM.RDS")
data_path <- "/Users/abnerteng/Desktop/DJ_split/recolumn_data/UNH.csv"
df = fread(data_path)
#df = as.data.table(df[,1:8])
#setnames(df,1:5,c("Open","High","Low","Close","Volume"))
#group_id = sort(rep(1:(nrow(df)/20),20))
group_id = paste0(df[,y],df[,m])
df = df[1:length(group_id)]
df[,group_id := group_id]
## fig_path <- paste0("/Users/abnerteng/Desktop/DJ_stock_fig/AAPL/AAPL_",group_id, sep = "")
plot_ohlc = function(df,filename="plot_01") {
png(paste0(filename,".png"),width=60,height=60)
layout(matrix(1:2,2,1),
heights=c(4,1))    # the ratio between price and volume chart is 60:15
par(mar=c(0,0,0,0),
bg="black",
fg="white",
lwd=1)
plot.new()
plot.window(xlim=c(0,59),   # x starts from zero
ylim=c(min(df[,Low]),max(df[,High])),
xaxs='i'
)
x.pos = seq(1,58,3)   # day 1 is x=1, and leave one pixel each at left and right (x=0,x=2)
# draw vertical line High-Low
segments(x.pos,df[,Low],x.pos,df[,High])
# draw CLOSE notch
segments(x.pos,df[,Close],x.pos+1,df[,Close])
# draw OPEN notch
segments(x.pos-1,df[,Open],x.pos,df[,Open])
# draw MA line
segments(x.pos-1,df[,MA],x.pos+1,df[,MA])
# add Volume
plot.new()
plot.window(xlim=c(0,59),
ylim=range(df[,Volume]),
xaxs='i'
)
segments(x.pos,0,x.pos,df[,Volume])
dev.off()
}
df[,plot_ohlc(.SD,filename=group_id),
by=group_id]
#library(quantmod)
#getSymbols("IBM", src="yahoo")
library(data.table)
#IBM = readRDS("IBM.RDS")
data_path <- "/Users/abnerteng/Desktop/DJ_split/recolumn_data/V.csv"
df = fread(data_path)
#df = as.data.table(df[,1:8])
#setnames(df,1:5,c("Open","High","Low","Close","Volume"))
#group_id = sort(rep(1:(nrow(df)/20),20))
group_id = paste0(df[,y],df[,m])
df = df[1:length(group_id)]
df[,group_id := group_id]
## fig_path <- paste0("/Users/abnerteng/Desktop/DJ_stock_fig/AAPL/AAPL_",group_id, sep = "")
plot_ohlc = function(df,filename="plot_01") {
png(paste0(filename,".png"),width=60,height=60)
layout(matrix(1:2,2,1),
heights=c(4,1))    # the ratio between price and volume chart is 60:15
par(mar=c(0,0,0,0),
bg="black",
fg="white",
lwd=1)
plot.new()
plot.window(xlim=c(0,59),   # x starts from zero
ylim=c(min(df[,Low]),max(df[,High])),
xaxs='i'
)
x.pos = seq(1,58,3)   # day 1 is x=1, and leave one pixel each at left and right (x=0,x=2)
# draw vertical line High-Low
segments(x.pos,df[,Low],x.pos,df[,High])
# draw CLOSE notch
segments(x.pos,df[,Close],x.pos+1,df[,Close])
# draw OPEN notch
segments(x.pos-1,df[,Open],x.pos,df[,Open])
# draw MA line
segments(x.pos-1,df[,MA],x.pos+1,df[,MA])
# add Volume
plot.new()
plot.window(xlim=c(0,59),
ylim=range(df[,Volume]),
xaxs='i'
)
segments(x.pos,0,x.pos,df[,Volume])
dev.off()
}
df[,plot_ohlc(.SD,filename=group_id),
by=group_id]
#library(quantmod)
#getSymbols("IBM", src="yahoo")
library(data.table)
#IBM = readRDS("IBM.RDS")
data_path <- "/Users/abnerteng/Desktop/DJ_split/recolumn_data/VZ.csv"
df = fread(data_path)
#df = as.data.table(df[,1:8])
#setnames(df,1:5,c("Open","High","Low","Close","Volume"))
#group_id = sort(rep(1:(nrow(df)/20),20))
group_id = paste0(df[,y],df[,m])
df = df[1:length(group_id)]
df[,group_id := group_id]
## fig_path <- paste0("/Users/abnerteng/Desktop/DJ_stock_fig/AAPL/AAPL_",group_id, sep = "")
plot_ohlc = function(df,filename="plot_01") {
png(paste0(filename,".png"),width=60,height=60)
layout(matrix(1:2,2,1),
heights=c(4,1))    # the ratio between price and volume chart is 60:15
par(mar=c(0,0,0,0),
bg="black",
fg="white",
lwd=1)
plot.new()
plot.window(xlim=c(0,59),   # x starts from zero
ylim=c(min(df[,Low]),max(df[,High])),
xaxs='i'
)
x.pos = seq(1,58,3)   # day 1 is x=1, and leave one pixel each at left and right (x=0,x=2)
# draw vertical line High-Low
segments(x.pos,df[,Low],x.pos,df[,High])
# draw CLOSE notch
segments(x.pos,df[,Close],x.pos+1,df[,Close])
# draw OPEN notch
segments(x.pos-1,df[,Open],x.pos,df[,Open])
# draw MA line
segments(x.pos-1,df[,MA],x.pos+1,df[,MA])
# add Volume
plot.new()
plot.window(xlim=c(0,59),
ylim=range(df[,Volume]),
xaxs='i'
)
segments(x.pos,0,x.pos,df[,Volume])
dev.off()
}
df[,plot_ohlc(.SD,filename=group_id),
by=group_id]
#library(quantmod)
#getSymbols("IBM", src="yahoo")
library(data.table)
#IBM = readRDS("IBM.RDS")
data_path <- "/Users/abnerteng/Desktop/DJ_split/recolumn_data/WBA.csv"
df = fread(data_path)
#df = as.data.table(df[,1:8])
#setnames(df,1:5,c("Open","High","Low","Close","Volume"))
#group_id = sort(rep(1:(nrow(df)/20),20))
group_id = paste0(df[,y],df[,m])
df = df[1:length(group_id)]
df[,group_id := group_id]
## fig_path <- paste0("/Users/abnerteng/Desktop/DJ_stock_fig/AAPL/AAPL_",group_id, sep = "")
plot_ohlc = function(df,filename="plot_01") {
png(paste0(filename,".png"),width=60,height=60)
layout(matrix(1:2,2,1),
heights=c(4,1))    # the ratio between price and volume chart is 60:15
par(mar=c(0,0,0,0),
bg="black",
fg="white",
lwd=1)
plot.new()
plot.window(xlim=c(0,59),   # x starts from zero
ylim=c(min(df[,Low]),max(df[,High])),
xaxs='i'
)
x.pos = seq(1,58,3)   # day 1 is x=1, and leave one pixel each at left and right (x=0,x=2)
# draw vertical line High-Low
segments(x.pos,df[,Low],x.pos,df[,High])
# draw CLOSE notch
segments(x.pos,df[,Close],x.pos+1,df[,Close])
# draw OPEN notch
segments(x.pos-1,df[,Open],x.pos,df[,Open])
# draw MA line
segments(x.pos-1,df[,MA],x.pos+1,df[,MA])
# add Volume
plot.new()
plot.window(xlim=c(0,59),
ylim=range(df[,Volume]),
xaxs='i'
)
segments(x.pos,0,x.pos,df[,Volume])
dev.off()
}
df[,plot_ohlc(.SD,filename=group_id),
by=group_id]
#library(quantmod)
#getSymbols("IBM", src="yahoo")
library(data.table)
#IBM = readRDS("IBM.RDS")
data_path <- "/Users/abnerteng/Desktop/DJ_split/recolumn_data/WMT.csv"
df = fread(data_path)
#df = as.data.table(df[,1:8])
#setnames(df,1:5,c("Open","High","Low","Close","Volume"))
#group_id = sort(rep(1:(nrow(df)/20),20))
group_id = paste0(df[,y],df[,m])
df = df[1:length(group_id)]
df[,group_id := group_id]
## fig_path <- paste0("/Users/abnerteng/Desktop/DJ_stock_fig/AAPL/AAPL_",group_id, sep = "")
plot_ohlc = function(df,filename="plot_01") {
png(paste0(filename,".png"),width=60,height=60)
layout(matrix(1:2,2,1),
heights=c(4,1))    # the ratio between price and volume chart is 60:15
par(mar=c(0,0,0,0),
bg="black",
fg="white",
lwd=1)
plot.new()
plot.window(xlim=c(0,59),   # x starts from zero
ylim=c(min(df[,Low]),max(df[,High])),
xaxs='i'
)
x.pos = seq(1,58,3)   # day 1 is x=1, and leave one pixel each at left and right (x=0,x=2)
# draw vertical line High-Low
segments(x.pos,df[,Low],x.pos,df[,High])
# draw CLOSE notch
segments(x.pos,df[,Close],x.pos+1,df[,Close])
# draw OPEN notch
segments(x.pos-1,df[,Open],x.pos,df[,Open])
# draw MA line
segments(x.pos-1,df[,MA],x.pos+1,df[,MA])
# add Volume
plot.new()
plot.window(xlim=c(0,59),
ylim=range(df[,Volume]),
xaxs='i'
)
segments(x.pos,0,x.pos,df[,Volume])
dev.off()
}
df[,plot_ohlc(.SD,filename=group_id),
by=group_id]
